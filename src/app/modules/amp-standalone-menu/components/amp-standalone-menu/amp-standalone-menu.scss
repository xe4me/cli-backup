@import '../../../../../styles/abstracts';
@import './amp-standalone-menu.mixins';

$amp-ddc-menu-height: $menu-height;
$amp-ddc-menu-border-width: 1px;
$amp-ddc-menu-padding-top: 20px;
$amp-ddc-menu-padding-bottom: 15px;

$amp-ddc-menu-font-size: 14px;
$amp-ddc-menu-step-spacing-bottom: 33px;
$amp-ddc-menu-step-spacing-left: 15px;
$amp-ddc-menu-line-width: 2px;
$amp-ddc-menu-circle-width: 13px;
$amp-ddc-menu-circle-stroke: 1px;
$amp-ddc-menu-circle-inner-width: floor($amp-ddc-menu-circle-width / 2);
$amp-ddc-menu-circle-offset: 5px;

$amp-ddc-menu-color-default: $amp-colour-sky-blue;
$amp-ddc-menu-color-dark: $amp-colour-primary;

:host {
    display: block;
}

.hidden {
    display : none;
}

.steps-menu {
    @include amp-family($amp-font-open-sans-regular);
    font-size: $amp-ddc-menu-font-size;
    position: absolute;
    top: 0;
    padding: 70px 0;
    z-index: 100;

    &--sticky {
        position: fixed;
    }

    &--bottom {
        position: absolute;
        top: auto;
        bottom: 0;
    }

    @include media-query(palm) {
        background: $amp-colour-white;
        overflow: hidden;
        padding: 0;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 70px;
        @include transform(translate3d(0, 0 , 0));
    }

    @include media-query(tablet-and-up) {
        max-width: 180px;
    }

    &--open {
        @include media-query(palm) {
            padding-bottom: $amp-ddc-menu-height;
        }
    }

    &__btn {
        @include amp-family($amp-font-open-sans-regular);
        background: $amp-colour-grey-semiwhite;
        border: 0;
        border-bottom: $amp-ddc-menu-border-width solid $amp-colour-grey-dark;
        color: $amp-ddc-menu-color-default;
        cursor: pointer;
        display: none;
        font-size: $amp-ddc-menu-font-size;
        font-weight: bold;
        height: $amp-ddc-menu-height;
        padding: $amp-ddc-menu-padding-top $amp-ddc-menu-padding-top $amp-ddc-menu-padding-bottom $amp-ddc-menu-padding-top;
        text-align: center;
        width: 100%;
        z-index: 10;
        position: absolute;
        bottom: 0;
        left: 0;

        @include media-query(palm) {
            display: block;
        }

        @include menu-theme(forms) {
            color: $amp-ddc-menu-color-dark;
        }

        &-icon {
            display: block;
            line-height: 1;
            margin: 0;
        }

        &--docked {
            border: 0;
            border-top: 1px solid $amp-colour-grey-dark;
            z-index: 10;
        }
    }

    &__nav {
        display: block;
        height: 100%;

        @include media-query(palm) {
            overflow: auto;
        }
    }

    &__list {
        list-style: none;

        @include media-query(palm) {
            margin: 40px 30px;
        }
    }

    &__item {
        color: $amp-colour-grey-darker;
        padding-bottom: $amp-ddc-menu-step-spacing-bottom;
        position: relative;

        &:last-child {
            padding-bottom: 0;

            &::before {
                display: none;
            }
        }

        // Line between steps
        &::before {
            background: $amp-colour-grey-darker;
            content: "";
            display: block;
            height: calc(100% - #{$amp-ddc-menu-circle-width - ($amp-ddc-menu-circle-stroke * 2)});
            position: absolute;
            left: floor(($amp-ddc-menu-circle-width / 2) - ($amp-ddc-menu-line-width / 2));
            top: $amp-ddc-menu-circle-width + $amp-ddc-menu-circle-offset - ($amp-ddc-menu-circle-stroke * 2);
            width: $amp-ddc-menu-line-width;
            z-index: 1;

            @include menu-theme(forms) {
                background: $amp-ddc-menu-color-dark !important;
            }
        }

        &.done {
            &::before {
                background: $amp-ddc-menu-color-default;
            }
        }
    }

    &__step {
        display: inline-block;
        padding-left: $amp-ddc-menu-step-spacing-left + $amp-ddc-menu-circle-width;
        position: relative;

        @include menu-state(active) {
            font-weight: 600;
        }

        &::before,
        &::after {
            background: transparent;
            border-radius: $amp-ddc-menu-circle-width;
            content: "";
            display: block;
            position: absolute;
            top: floor(($amp-ddc-menu-circle-width / 2) + $amp-ddc-menu-circle-offset);
            left: floor($amp-ddc-menu-circle-width / 2);
            @include transform(translate(-50%, -50%));
            z-index: 2;
        }

        // Outer circle for step
        &::before {
            border: $amp-ddc-menu-circle-stroke solid $amp-colour-grey-darker;
            height: $amp-ddc-menu-circle-width - $amp-ddc-menu-circle-stroke;
            width: $amp-ddc-menu-circle-width - $amp-ddc-menu-circle-stroke;

            @include menu-theme(forms) {
                border-color: $amp-ddc-menu-color-dark !important;
            }

            @include menu-state(done) {
                background: $amp-ddc-menu-color-default;
                border-color: $amp-ddc-menu-color-default;

                @include menu-theme(forms) {
                    background: $amp-ddc-menu-color-dark;
                }
            }

            @include menu-state(active) {
                background: none !important;
                border-color: $amp-ddc-menu-color-default;
            }

        }

        // Inner circle for step
        &::after {
            @include menu-state(active) {
                background: $amp-ddc-menu-color-default;
                height: $amp-ddc-menu-circle-inner-width;
                width: $amp-ddc-menu-circle-inner-width;

                @include menu-theme(forms) {
                    background: $amp-ddc-menu-color-dark;
                }
            }
        }

        @at-root a#{&} {
            color: $amp-ddc-menu-color-default;

            @include menu-theme(forms) {
                color: $amp-ddc-menu-color-dark;
            }

            &:focus,
            &:hover {
                color: $amp-ddc-menu-color-default !important;
            }
        }
    }
}
